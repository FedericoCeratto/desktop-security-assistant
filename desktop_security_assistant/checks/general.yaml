---
- name: debian
  desc: On Debian systems, run security updates frequently with apt-get or synaptic
  difficulty: 1
  python: os.path.isfile('/etc/debian_version')

- name: debian security archive
  desc: Ensure the security archive is configured in APT
  url: https://www.debian.org/doc/manuals/securing-debian-howto/ch4.en.html#s-security-update
  risk: 3
  difficulty: 2
  depends_on: debian
  bash: apt-cache policy | grep -q security

- name: apt-get update
  desc: The APT package index has not been updated in more than 7 days. Update it with with "apt-get update" or synaptic
  risk: 3
  difficulty: 1
  depends_on: debian
  bash: find /var/cache/apt/pkgcache.bin -mtime +7 | grep -q pkgcache; exit $((1-$?))

- name: apt-get security
  desc: The are security updates to be installed. Perform an upgrade with "apt-get upgrade" or synaptic
  risk: 3
  difficulty: 1
  depends_on: debian
  bash: apt-get -s dist-upgrade |grep "^Inst" |grep -q -i ':securi'; exit $((1-$?))

- name: bios password
  desc: Configure a password on your BIOS
  url: https://www.debian.org/doc/manuals/securing-debian-howto/ch3.en.html#s-bios-passwd
  risk: 2
  difficulty: 3

- name: harden-tools
  desc: Install the harden-tools package
  url: https://www.debian.org/doc/manuals/securing-debian-howto/ch-automatic-harden.en.html#s6.1
  risk: 1
  difficulty: 4
  depends_on: debian

- name: harden-clients
  desc: Install the harden-clients package
  url: https://www.debian.org/doc/manuals/securing-debian-howto/ch-automatic-harden.en.html#s6.1
  risk: 1
  difficulty: 3
  depends_on: debian

- name: sysrq
  desc: Consider disabling the Magic SysRq key
  url: https://www.debian.org/doc/manuals/securing-debian-howto/ch4.en.html#s-restrict-sysrq
  risk: 1
  difficulty: 4
  depends_on: debian
  bash: /sbin/sysctl kernel.sysrq | grep -q ' 0$'

- name: bleachbit
  desc: Use bleachbit regularly to improve your privacy
  url: http://bleachbit.sourceforge.net/
  risk: 2
  difficulty: 2

- name: install vrms
  desc: Install the vrms application to detect non-free installed software
  url: https://en.wikipedia.org/wiki/Vrms
  risk: 2
  difficulty: 1
  python: not os.path.isfile('/usr/bin/vrms')

- name: vrms
  desc: The vrms application detected non-free software on your system. Run "vrms" in a terminal to have a detailed report.
  url: https://en.wikipedia.org/wiki/Vrms
  risk: 2
  difficulty: 2
  # Return the check as active only if vrms is installed and it is returning any package name (ignore blank lines)
  bash: test -f /usr/bin/vrms && /usr/bin/vrms -s | grep -q -e '[[:alnum:]]'; exit $((1-$?))

- name: xscreensaver
  desc: xscreensaver is not running. Consider installing and running it to lock your screen when you are away.
  risk: 1
  difficulty: 1
  bash: pgrep -c xscreensaver

- name: iceweasel-firefox
  desc: Iceweasel or Firefox are installed.
  risk: 2
  bash: dpkg -l firefox iceweasel >/dev/null; exit $((1-$?))

- name: NoScript
  desc: Iceweasel or Firefox are installed. Consider using NoScript to block potentially harmful JavaScript using the xul-ext-noscript package
  risk: 3
  difficulty: 2
  bash: dpkg -l xul-ext-noscript > /dev/null
  depends_on: iceweasel-firefox

- name: Cookie Monster
  desc: Iceweasel or Firefox are installed. Consider using Cookie Monster to filter cookies using the xul-ext-cookie-monster package
  risk: 3
  difficulty: 2
  bash: dpkg -l xul-ext-cookie-monster > /dev/null
  depends_on: iceweasel-firefox

- name: flashblock
  desc: Iceweasel or Firefox are installed. Consider using flashblock to block potentially harmful Flash using the xul-ext-flashblock package
  risk: 3
  difficulty: 2
  bash: dpkg -l xul-ext-flashblock > /dev/null
  depends_on: iceweasel-firefox

- name: flashplugin
  desc: The "flashplugin-nonfree" package is installed. Keep in mind that the package cannot receive security updates from Debian
  url: https://wiki.debian.org/FlashPlayer
  risk: 3
  difficulty: 2
  bash: dpkg -l xul-ext-cookie-monster > /dev/null
  depends_on: debian

# TODO: calibre plugins, vim plugins, bios, disk encryption, swap encryption
# wipe on shutdown/suspend: ram, swap, gnupg password, ssh agent, disk password
# (by unmounting it), /tmp
